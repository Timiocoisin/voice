2026-01-13 14:25:24,956 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=544, session_id=chat_1_225298ba, from_user_id=1, role=user, chat_session={'id': 135, 'session_id': 'chat_1_225298ba', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 14, 25, 21), 'started_at': None, 'closed_at': None}
2026-01-13 14:27:37,722 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=545, session_id=chat_1_9ac8052e, from_user_id=1, role=user, chat_session={'id': 136, 'session_id': 'chat_1_9ac8052e', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 14, 27, 34), 'started_at': None, 'closed_at': None}
2026-01-13 14:45:10,570 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=561, session_id=chat_1_327c6f13, from_user_id=1, role=user, chat_session={'id': 139, 'session_id': 'chat_1_327c6f13', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 14, 45, 6), 'started_at': None, 'closed_at': None}
2026-01-13 17:26:28,255 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=610, session_id=chat_1_8c61b34e, from_user_id=1, role=user, chat_session={'id': 149, 'session_id': 'chat_1_8c61b34e', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 17, 26, 23), 'started_at': None, 'closed_at': None}
2026-01-13 17:26:35,545 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=611, session_id=chat_1_8c61b34e, from_user_id=1, role=user, chat_session={'id': 149, 'session_id': 'chat_1_8c61b34e', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 17, 26, 23), 'started_at': None, 'closed_at': None}
2026-01-13 17:29:24,892 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=612, session_id=chat_1_fdaf2c61, from_user_id=1, role=user, chat_session={'id': 150, 'session_id': 'chat_1_fdaf2c61', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 17, 29, 19), 'started_at': None, 'closed_at': None}
2026-01-13 17:29:28,749 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=613, session_id=chat_1_fdaf2c61, from_user_id=1, role=user, chat_session={'id': 150, 'session_id': 'chat_1_fdaf2c61', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 17, 29, 19), 'started_at': None, 'closed_at': None}
2026-01-13 17:47:51,272 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=622, session_id=chat_1_ae242275, from_user_id=1, role=user, chat_session={'id': 154, 'session_id': 'chat_1_ae242275', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 17, 47, 44), 'started_at': None, 'closed_at': None}
2026-01-13 17:47:55,228 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=623, session_id=chat_1_ae242275, from_user_id=1, role=user, chat_session={'id': 154, 'session_id': 'chat_1_ae242275', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 17, 47, 44), 'started_at': None, 'closed_at': None}
2026-01-13 19:00:10,842 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=627, session_id=chat_1_8cf6821c, from_user_id=1, role=user, chat_session={'id': 156, 'session_id': 'chat_1_8cf6821c', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 0, 5), 'started_at': None, 'closed_at': None}
2026-01-13 19:00:15,923 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=628, session_id=chat_1_8cf6821c, from_user_id=1, role=user, chat_session={'id': 156, 'session_id': 'chat_1_8cf6821c', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 0, 5), 'started_at': None, 'closed_at': None}
2026-01-13 19:46:39,005 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=642, session_id=chat_1_cbb4fa52, from_user_id=1, role=user, chat_session={'id': 162, 'session_id': 'chat_1_cbb4fa52', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 46, 34), 'started_at': None, 'closed_at': None}
2026-01-13 19:46:42,694 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=643, session_id=chat_1_cbb4fa52, from_user_id=1, role=user, chat_session={'id': 162, 'session_id': 'chat_1_cbb4fa52', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 46, 34), 'started_at': None, 'closed_at': None}
2026-01-13 19:52:33,452 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=644, session_id=chat_1_85b1359a, from_user_id=1, role=user, chat_session={'id': 163, 'session_id': 'chat_1_85b1359a', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 52, 29), 'started_at': None, 'closed_at': None}
2026-01-13 19:52:38,297 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=645, session_id=chat_1_85b1359a, from_user_id=1, role=user, chat_session={'id': 163, 'session_id': 'chat_1_85b1359a', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 52, 29), 'started_at': None, 'closed_at': None}
2026-01-13 19:52:40,658 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=646, session_id=chat_1_85b1359a, from_user_id=1, role=user, chat_session={'id': 163, 'session_id': 'chat_1_85b1359a', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 19, 52, 29), 'started_at': None, 'closed_at': None}
2026-01-13 20:42:43,763 - ERROR - __main__ - 无法推送消息：to_user_id为None, message_id=654, session_id=chat_1_738ad2a9, from_user_id=1, role=user, chat_session={'id': 167, 'session_id': 'chat_1_738ad2a9', 'user_id': 1, 'agent_id': None, 'status': 'pending', 'created_at': datetime.datetime(2026, 1, 13, 20, 42, 37), 'started_at': None, 'closed_at': None}
2026-01-16 16:51:24,566 - ERROR - __main__ - ❌ AsyncDatabaseManager 初始化失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_migration.py", line 62, in test_async_db_manager_init
    db_manager = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 16:51:24,568 - ERROR - __main__ - ❌ 方法检查失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_migration.py", line 84, in test_async_db_manager_methods
    db_manager = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 16:51:24,585 - ERROR - __main__ - ❌ AsyncWebSocketManager 测试失败: No module named 'socketio'
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_migration.py", line 133, in test_async_websocket_manager
    from backend.websocket.async_websocket_manager import AsyncWebSocketManager
  File "D:\Desktop\work\change_voice\backend\websocket\async_websocket_manager.py", line 12, in <module>
    import socketio
ModuleNotFoundError: No module named 'socketio'
2026-01-16 16:51:24,586 - ERROR - __main__ - ❌ 数据库配置读取失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_migration.py", line 260, in test_database_connection
    config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 16:51:24,587 - ERROR - __main__ - ❌ Pydantic Schemas: 失败
2026-01-16 16:51:24,587 - ERROR - __main__ - ❌ FastAPI App: 失败
2026-01-16 16:51:24,587 - ERROR - __main__ - ❌ Async DB Manager Init: 失败
2026-01-16 16:51:24,587 - ERROR - __main__ - ❌ Async DB Manager Methods: 失败
2026-01-16 16:51:24,587 - ERROR - __main__ - ❌ Async WebSocket Manager: 失败
2026-01-16 16:51:24,587 - ERROR - __main__ - ❌ Database Config: 失败
2026-01-16 16:52:38,180 - ERROR - __main__ - ❌ AsyncWebSocketManager 测试失败: partially initialized module 'socketio' from 'D:\anaconda3\Lib\site-packages\socketio\__init__.py' has no attribute 'AsyncServer' (most likely due to a circular import)
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_migration.py", line 144, in test_async_websocket_manager
    from backend.websocket.async_websocket_manager import AsyncWebSocketManager
  File "D:\Desktop\work\change_voice\backend\websocket\__init__.py", line 11, in <module>
    from .async_websocket_manager import AsyncWebSocketManager
  File "D:\Desktop\work\change_voice\backend\websocket\async_websocket_manager.py", line 12, in <module>
    import socketio
  File "D:\anaconda3\Lib\site-packages\socketio\__init__.py", line 1, in <module>
    from .client import Client
  File "D:\anaconda3\Lib\site-packages\socketio\client.py", line 3, in <module>
    import engineio
  File "D:\anaconda3\Lib\site-packages\engineio\__init__.py", line 1, in <module>
    from .client import Client
  File "D:\anaconda3\Lib\site-packages\engineio\client.py", line 16, in <module>
    import websocket
  File "D:\Desktop\work\change_voice\backend\websocket\__init__.py", line 11, in <module>
    from .async_websocket_manager import AsyncWebSocketManager
  File "D:\Desktop\work\change_voice\backend\websocket\async_websocket_manager.py", line 17, in <module>
    class AsyncWebSocketManager:
    ...<692 lines>...
            }
  File "D:\Desktop\work\change_voice\backend\websocket\async_websocket_manager.py", line 20, in AsyncWebSocketManager
    def __init__(self, socketio_server: socketio.AsyncServer, db_manager):
                                        ^^^^^^^^^^^^^^^^^^^^
AttributeError: partially initialized module 'socketio' from 'D:\anaconda3\Lib\site-packages\socketio\__init__.py' has no attribute 'AsyncServer' (most likely due to a circular import)
2026-01-16 16:52:38,194 - ERROR - __main__ - ❌ 数据库配置读取失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_migration.py", line 271, in test_database_connection
    config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 16:52:38,196 - ERROR - __main__ - ❌ FastAPI App: 失败
2026-01-16 16:52:38,196 - ERROR - __main__ - ❌ Async WebSocket Manager: 失败
2026-01-16 16:52:38,196 - ERROR - __main__ - ❌ Database Config: 失败
2026-01-16 18:09:17,607 - ERROR - __main__ - ❌ Pydantic schemas 测试失败: cannot import name 'UserResponse' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 206, in test_pydantic_schemas
    from backend.api.schemas import (
    ...<2 lines>...
    )
ImportError: cannot import name 'UserResponse' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
2026-01-16 18:09:17,608 - ERROR - __main__ - ❌ 数据库连接失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:09:17,610 - ERROR - __main__ - ❌ 会员服务测试失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 60, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:09:17,610 - ERROR - __main__ - ❌ WebSocket 管理器测试失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 85, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:09:19,119 - ERROR - __main__ - ❌ FastAPI 应用测试失败: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 114, in test_fastapi_app
    from backend.api_server_fastapi import app, db, ws_manager
  File "D:\Desktop\work\change_voice\backend\api_server_fastapi.py", line 75, in <module>
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:23,883 - ERROR - __main__ - ❌ Pydantic schemas 测试失败: cannot import name 'UserBase' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 227, in test_pydantic_schemas
    from backend.api.schemas import (
    ...<2 lines>...
    )
ImportError: cannot import name 'UserBase' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
2026-01-16 18:11:23,885 - ERROR - __main__ - ❌ 测试 '数据库连接' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:23,887 - ERROR - __main__ - ❌ 测试 '会员服务' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 65, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:23,889 - ERROR - __main__ - ❌ 测试 'WebSocket 管理器' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 95, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:24,978 - ERROR - __main__ - ❌ 测试 'FastAPI 应用' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 129, in test_fastapi_app
    from backend.api_server_fastapi import app
  File "D:\Desktop\work\change_voice\backend\api_server_fastapi.py", line 75, in <module>
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:52,052 - ERROR - __main__ - ❌ Pydantic schemas 测试失败: cannot import name 'TokenResponse' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 227, in test_pydantic_schemas
    from backend.api.schemas import (
    ...<2 lines>...
    )
ImportError: cannot import name 'TokenResponse' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
2026-01-16 18:11:52,054 - ERROR - __main__ - ❌ 测试 '数据库连接' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:52,055 - ERROR - __main__ - ❌ 测试 '会员服务' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 65, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:52,056 - ERROR - __main__ - ❌ 测试 'WebSocket 管理器' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 95, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:11:53,269 - ERROR - __main__ - ❌ 测试 'FastAPI 应用' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 267, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 129, in test_fastapi_app
    from backend.api_server_fastapi import app
  File "D:\Desktop\work\change_voice\backend\api_server_fastapi.py", line 75, in <module>
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:12:13,837 - ERROR - __main__ - ❌ Pydantic schemas 测试失败: cannot import name 'MessageResponse' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 227, in test_pydantic_schemas
    from backend.api.schemas import (
    ...<2 lines>...
    )
ImportError: cannot import name 'MessageResponse' from 'backend.api.schemas' (D:\Desktop\work\change_voice\backend\api\schemas.py)
2026-01-16 18:12:13,838 - ERROR - __main__ - ❌ 测试 '数据库连接' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:12:13,840 - ERROR - __main__ - ❌ 测试 '会员服务' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 65, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:12:13,841 - ERROR - __main__ - ❌ 测试 'WebSocket 管理器' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 95, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:12:14,950 - ERROR - __main__ - ❌ 测试 'FastAPI 应用' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 129, in test_fastapi_app
    from backend.api_server_fastapi import app
  File "D:\Desktop\work\change_voice\backend\api_server_fastapi.py", line 75, in <module>
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:42:52,970 - ERROR - __main__ - ❌ 测试 '数据库连接' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:42:52,972 - ERROR - __main__ - ❌ 测试 '会员服务' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 65, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:42:52,973 - ERROR - __main__ - ❌ 测试 'WebSocket 管理器' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 95, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:42:54,078 - ERROR - __main__ - ❌ 测试 'FastAPI 应用' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 129, in test_fastapi_app
    from backend.api_server_fastapi import app
  File "D:\Desktop\work\change_voice\backend\api_server_fastapi.py", line 75, in <module>
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:43:51,357 - ERROR - __main__ - ❌ 测试 '数据库连接' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:43:51,360 - ERROR - __main__ - ❌ 测试 '会员服务' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 65, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:43:51,361 - ERROR - __main__ - ❌ 测试 'WebSocket 管理器' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 95, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:43:52,672 - ERROR - __main__ - ❌ 测试 'FastAPI 应用' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 129, in test_fastapi_app
    from backend.api_server_fastapi import app
  File "D:\Desktop\work\change_voice\backend\api_server_fastapi.py", line 75, in <module>
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:46:16,666 - ERROR - __main__ - ❌ 测试 '数据库连接' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 38, in test_database_connection
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:46:16,668 - ERROR - __main__ - ❌ 测试 '会员服务' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 65, in test_membership_service
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 18:46:16,669 - ERROR - __main__ - ❌ 测试 'WebSocket 管理器' 执行异常: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 275, in run_all_tests
    result = await test_func()
             ^^^^^^^^^^^^^^^^^
  File "D:\Desktop\work\change_voice\backend\test_fastapi.py", line 95, in test_websocket_manager
    db = AsyncDatabaseManager()
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 38, in __init__
    db_config = get_database_config()
  File "D:\Desktop\work\change_voice\backend\config\database_config.py", line 34, in get_database_config
    raise ValueError(f"缺少必需的数据库配置项: {', '.join(missing_keys)}。请检查 .env 文件或环境变量设置。")
ValueError: 缺少必需的数据库配置项: host, user, password, database。请检查 .env 文件或环境变量设置。
2026-01-16 19:20:30,751 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 19:20:30,752 - ERROR - backend.database.async_database_manager - 初始化数据库表结构失败: (pymysql.err.OperationalError) (1130, "Host 'host.docker.internal' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-16 19:26:35,422 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 19:26:35,422 - ERROR - backend.database.async_database_manager - 初始化数据库表结构失败: (pymysql.err.OperationalError) (1130, "Host 'host.docker.internal' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-16 19:29:38,344 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 19:29:38,344 - ERROR - backend.database.async_database_manager - 初始化数据库表结构失败: (pymysql.err.OperationalError) (1130, "Host 'host.docker.internal' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-16 19:29:38,344 - ERROR - backend.database.async_database_manager - 失败时的数据库 URL (隐藏密码): mysql+aiomysql://root:***@***
2026-01-16 19:50:04,349 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 19:50:15,893 - ERROR - backend.database.async_database_manager - 查询用户信息失败: 'user' is not among the defined enum values. Enum name: userrole. Possible values: USER, ADMIN, CUSTOMER_SE..
2026-01-16 19:52:32,677 - ERROR - backend.database.async_database_manager - 查询用户信息失败: 'user' is not among the defined enum values. Enum name: userrole. Possible values: USER, ADMIN, CUSTOMER_SE..
Traceback (most recent call last):
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
KeyError: 'user'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Desktop\work\change_voice\backend\database\async_database_manager.py", line 92, in get_user_by_email
    result = await session.execute(
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\orm\context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\orm\context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\orm\loading.py", line 262, in instances
    _prebuffered = list(chunks(None))
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\engine\result.py", line 541, in <listcomp>
    return [make_row(row) for row in rows]
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "D:\anaconda3\envs\change_voice\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
LookupError: 'user' is not among the defined enum values. Enum name: userrole. Possible values: USER, ADMIN, CUSTOMER_SE..
2026-01-16 19:54:22,092 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 19:54:48,324 - ERROR - backend.database.async_database_manager - 更新客服状态失败: 'offline' is not among the defined enum values. Enum name: agentstatusenum. Possible values: ONLINE, OFFLINE, AWAY, BUSY
2026-01-16 19:54:48,390 - ERROR - backend.database.async_database_manager - 注册用户设备失败: 'web' is not among the defined enum values. Enum name: devicetype. Possible values: DESKTOP, MOBILE, WEB, OTHER
2026-01-16 19:54:48,484 - ERROR - backend.database.async_database_manager - 更新客服状态失败: 'offline' is not among the defined enum values. Enum name: agentstatusenum. Possible values: ONLINE, OFFLINE, AWAY, BUSY
2026-01-16 19:57:20,995 - ERROR - backend.database.async_database_manager - 更新客服状态失败: 'offline' is not among the defined enum values. Enum name: agentstatusenum. Possible values: ONLINE, OFFLINE, AWAY, BUSY
2026-01-16 19:57:21,080 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 19:57:21,081 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 20:04:52,254 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
2026-01-16 20:04:52,255 - ERROR - asyncio - An open stream object is being garbage collected; call "stream.close()" explicitly.
